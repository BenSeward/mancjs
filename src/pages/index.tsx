import Head from "next/head";
import { Lato } from "next/font/google";
import { Header } from "@/components/Header";
import { Container } from "@/components/Container";
import { EventCard } from "@/components/EventCard";
import { Section } from "@/components/Section";
import { Footer } from "@/components/Footer";
import useSWR from "swr";

const fetcher = (url: RequestInfo | URL) =>
  fetch(url).then((res) => res.json());

const lato = Lato({
  subsets: ["latin"],
  weight: ["100", "300", "400", "700"],
});

export default function Home() {
  const { data, error, isLoading } = useSWR("/api/events", fetcher);

  if (error) return "An error has occurred.";
  if (isLoading) return "Loading...";
  // how to format date?
  // how to update which event will be next?
  const nextEvent = data.mancJSEvents[0]
  return (
    <>
      <Head>
        <title>Manc.JS</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main className={lato.className}>
        <Container>
          <Header />

          <Section
            header={"Welcome to Manc.JS"}
            paragraph={
              "We run Javascript & tech events every-other month around central Manchester."
            }
            buttonText={"Join our next event!"}
            link={"/"}
          />

          <h2>Next event</h2>
          <EventCard
            thumbnailUrl="https://secure.meetupstatic.com/photos/event/9/1/9/3/clean_478597267.jpg"
            title={nextEvent.name}
            eventDate={nextEvent.local_date}
            eventTime={nextEvent.local_time}
            location={nextEvent.venue.name}
            lat={nextEvent.venue.lat}
            lon={nextEvent.venue.lon}
            buttonText={"Join our next event!"}
            link={nextEvent.link}
          />

          <h2>Previous events</h2>
          <EventCard
            thumbnailUrl="https://secure.meetupstatic.com/photos/event/9/1/9/3/clean_478597267.jpg"
            title="ðŸŽ‰ Manc.JS - 10th Birthday party ðŸŽ‰"
            eventDate="Wednesday, 22nd March - "
            eventTime="6:00 PM GMT"
            location="Slalom offices,  M1 ABC"
            lat={nextEvent.venue.lat}
            lon={nextEvent.venue.lon}
            buttonText={"See event details"}
            variant="secondary"
            link={"/"}
          />

          <Section
            header={"Get in touch"}
            paragraph={
              "We love hearing from our community. If you want to come to an event but have a question reach out to one of our organisers on Meetup."
            }
            buttonText={"Get in touch"}
            link={"/"}
          />
        </Container>
        <Footer />
      </main>
    </>
  );
}
